[
  {
    "objectID": "portfolio.html",
    "href": "portfolio.html",
    "title": "Portfolio",
    "section": "",
    "text": "This data science project portfolio showcases my work in data analysis, visualization, and machine learning.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCalculating narrow-sense heritability\n\n\n\n\n\n\nrrBLUP\n\n\nR\n\n\n\nEstimating the genetic component of yield using the rrBLUP package on common bean yield data from the CDBN\n\n\n\n\n\nApr 3, 2024\n\n\nAlice MacQueen\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Alice MacQueen",
    "section": "",
    "text": "Alice MacQueen is a computational biologist with a Ph.D. from the University of Chicago and a background in quantitative population genetics, who focuses on identifying molecular variation to solve problems that impact human well-being.\nSpecifically, Alice uses R to solve problems and generate insight in agricultural and immunological sequencing data using linear mixed models, Bayesian multivariate adaptive shrinkage, and statistical association methods."
  },
  {
    "objectID": "index.html#data-science-project-portfolio",
    "href": "index.html#data-science-project-portfolio",
    "title": "Alice MacQueen",
    "section": "",
    "text": "Alice MacQueen is a computational biologist with a Ph.D. from the University of Chicago and a background in quantitative population genetics, who focuses on identifying molecular variation to solve problems that impact human well-being.\nSpecifically, Alice uses R to solve problems and generate insight in agricultural and immunological sequencing data using linear mixed models, Bayesian multivariate adaptive shrinkage, and statistical association methods."
  },
  {
    "objectID": "resume.html",
    "href": "resume.html",
    "title": "Resume",
    "section": "",
    "text": "Download Resume"
  },
  {
    "objectID": "resume.html#header",
    "href": "resume.html#header",
    "title": "Resume",
    "section": "Header",
    "text": "Header\nSay more about your Resume here."
  },
  {
    "objectID": "portfolio/2024-04-03-heritability/index.html",
    "href": "portfolio/2024-04-03-heritability/index.html",
    "title": "Calculating narrow-sense heritability",
    "section": "",
    "text": "Narrow-sense heritability, or h2, is a descriptive statistic calculated by geneticists and crop breeders prior to modeling the association between a trait (such as height or yield) and molecular variation present in a population (such as single nucleotide polymorphisms, or SNPs).\nIt varies between 0 and 1 and is a measure of the fraction of the total variation in a trait attributable to additive effects of the molecular variation present in the group of individuals where the trait was measured. If it’s zero, or as a rule of thumb, 0.2 or less, there is little additive genetic variation for that trait, and any modeling of the association between the trait and molecular variation is likely to be unsuccessful.\nHere I calculate h2 for biomass data in the switchgrass diversity panel dataset.\nTo calculate h2, I need trait data for my group of interest (total biomass for genotypes in the switchgrass diversity panel data, at the Austin, Texas site, in 2019) and a kinship matrix. The kinship matrix here contains information about how the switchgrass individuals are genetically related to one another. I’ve pre-calculated the kinship matrix for these individuals using the Van Raden method (VanRaden 2008).\nThere are many factors that go in to making the kinship matrix, but I won’t go into the details of that here.\nFirst, load the R packages I’ll need to compute this statistic and load the kinship matrix.\n\nlibrary(tidyverse)\nlibrary(here)\nlibrary(rrBLUP)\nlibrary(switchgrassGWAS)\n\nk_full &lt;- read_rds(here(\"data\", \"Kinship_van_Raden_630_individuals_SNPs_r2_20percent.rds\"))\n\nThe kinship matrix is a matrix with column and row names that are individual plant IDs (PLANT_ID in the trait dataframe).\n\nstr(k_full)\n\n num [1:630, 1:630] 1.3406 0.0871 0.0746 0.0404 0.1924 ...\n - attr(*, \"dimnames\")=List of 2\n  ..$ : chr [1:630] \"J181.A\" \"J250.C\" \"J251.C\" \"J352.A\" ...\n  ..$ : chr [1:630] \"J181.A\" \"J250.C\" \"J251.C\" \"J352.A\" ...\n\nk_full[1:5, 1:5]\n\n           J181.A     J250.C     J251.C     J352.A     J001.A\nJ181.A 1.34059943 0.08712208 0.07459743 0.04039814 0.19244956\nJ250.C 0.08712208 1.25057146 0.30333836 0.09003609 0.14031216\nJ251.C 0.07459743 0.30333836 1.26267550 0.05864841 0.16804045\nJ352.A 0.04039814 0.09003609 0.05864841 1.35194085 0.04047479\nJ001.A 0.19244956 0.14031216 0.16804045 0.04047479 1.18593277\n\n\nNext, load the trait data. Here I am going to use the publicly available trait data from the switchgrassGWAS R package.\n\ntrait_data &lt;- switchgrassGWAS::pvdiv_phenotypes\n\nTo calculate narrow-sense heritability for one trait, CLMB_BIOMASS, I need to manipulate the trait dataframe so that the PLANT_ID included match the ones in the kinship matrix.\n\none_trait &lt;- trait_data |&gt; \n1  filter(!is.na(CLMB_BIOMASS)) |&gt;\n2  filter(PLANT_ID %in% colnames(k_full))\n\n\n1\n\nFilter individuals to those with data in the CLMB_BIOMASS column\n\n2\n\nFilter individuals to those with PLANT_ID that match the names in the kinship matrix.\n\n\n\n\nThen, I need to make sure that the same PLANT_ID are present in the kinship matrix and in the dataframe, in the same order. To do this, first I find the numerical values of the column names that are in the trait dataframe, then I subset the kinship matrix to just those values.\n\nk_in_phe &lt;- which(colnames(k_full) %in% one_trait$PLANT_ID)\nk_one &lt;- k_full[k_in_phe, k_in_phe]\n\nThen, make sure that the PLANT_ID in the trait dataframe are in the same order as those in the kinship matrix by making the PLANT_ID from the kinship matrix into a dataframe, and joining the trait dataframe to it.\n\nk_order &lt;- enframe(colnames(k_one), name = NULL, value = \"PLANT_ID\")\none_trait &lt;- k_order |&gt; \n  left_join(one_trait, by = \"PLANT_ID\")\n\nFinally, check that all the PLANT_ID in the two dataframes are equal.\n\nall.equal(k_order, select(one_trait, PLANT_ID))\n\n[1] TRUE\n\n\nNow, we used mixed.solve() from the rrBLUP package to calculate both the additive genetic variation (Vu) and the error variation in the trait (Ve). Added together, Vu and Ve make up the total trait variation in the population.\n\nmod2 &lt;- mixed.solve(y = one_trait$CLMB_BIOMASS, K = k_one)\n\nh2 &lt;- mod2$Vu/(mod2$Vu + mod2$Ve)\n\nround(h2, digits = 4)\n\n[1] 0.8923\n\n\nh2 for the biomass at CLMB is 0.8923. This is a very high heritability, suggesting that additive SNP-trait associations may explain much of the trait variation at this location.\n\n\n\n\nReferences\n\nVanRaden, P. M. 2008. “Efficient Methods to Compute Genomic Predictions.” Journal of Dairy Science 91 (11): 4414–23. https://doi.org/10.3168/jds.2007-0980.\n\nCitationBibTeX citation:@online{macqueen2024,\n  author = {MacQueen, Alice},\n  title = {Calculating Narrow-Sense Heritability},\n  date = {2024-04-03},\n  url = {https://alice-macqueen.github.io/posts/2024-04-03-heritability/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nMacQueen, Alice. 2024. “Calculating Narrow-Sense\nHeritability.” April 3, 2024. https://alice-macqueen.github.io/posts/2024-04-03-heritability/."
  }
]